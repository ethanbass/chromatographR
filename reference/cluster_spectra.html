<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cluster spectra — cluster_spectra • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster spectra — cluster_spectra"><meta name="description" content="Cluster peaks by spectral similarity."><meta property="og:description" content="Cluster peaks by spectral similarity."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/chromatographR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/uv_spectra.html">Programmatic analysis of UV spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cluster spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/master/R/cluster_spectra.R" class="external-link"><code>R/cluster_spectra.R</code></a></small>
      <div class="d-none name"><code>cluster_spectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cluster peaks by spectral similarity.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cluster_spectra</span><span class="op">(</span></span>
<span>  <span class="va">peak_table</span>,</span>
<span>  peak_no <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  plot_dend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_spectra <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span><span class="op">)</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pvclust"</span>, <span class="st">"clusters"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-peak-table">peak_table<a class="anchor" aria-label="anchor" href="#arg-peak-table"></a></dt>
<dd><p>Peak table from <code><a href="get_peaktable.html">get_peaktable</a></code>.</p></dd>


<dt id="arg-peak-no">peak_no<a class="anchor" aria-label="anchor" href="#arg-peak-no"></a></dt>
<dd><p>Minimum and maximum thresholds for the number of peaks a
cluster may have. This argument is deprecated in favor of <code>min_size</code> and
<code>max_size</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Confidence threshold for inclusion of cluster.</p></dd>


<dt id="arg-min-size">min_size<a class="anchor" aria-label="anchor" href="#arg-min-size"></a></dt>
<dd><p>Minimum number of peaks a cluster may have.</p></dd>


<dt id="arg-max-size">max_size<a class="anchor" aria-label="anchor" href="#arg-max-size"></a></dt>
<dd><p>Maximum number of peaks a cluster may have.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>Number of bootstrap replicates for
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>


<dt id="arg-plot-dend">plot_dend<a class="anchor" aria-label="anchor" href="#arg-plot-dend"></a></dt>
<dd><p>Logical. If TRUE, plots dendrogram with bootstrap values.</p></dd>


<dt id="arg-plot-spectra">plot_spectra<a class="anchor" aria-label="anchor" href="#arg-plot-spectra"></a></dt>
<dd><p>Logical. If TRUE, plots overlapping spectra for each
cluster.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, prints progress report to console.</p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>Logical. If TRUE, saves pvclust object to current directory.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical. If TRUE, use parallel processing for
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>


<dt id="arg-max-only">max.only<a class="anchor" aria-label="anchor" href="#arg-max-only"></a></dt>
<dd><p>Logical. If TRUE, returns only highest level for nested
dendrograms.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>What to return. Either <code>clusters</code> to return list of clusters,
<code>pvclust</code> to return pvclust object, or <code>both</code> to return both items.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to <code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns clusters and/or <code>pvclust</code> object according to the value
of the <code>output</code> argument.</p><ul><li><p>If <code>output = clusters</code>,  returns a list of S4 <code>cluster</code> objects.</p></li>
<li><p>If <code>output = pvclust</code>, returns a <code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>
object.</p></li>
<li><p>If <code>output = both</code>, returns a nested list containing <code>[[1]]</code> the
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code> object, and <code>[[2]]</code> the list of
S4 <code>cluster</code> objects.</p></li>
</ul><p>The <code>cluster</code> objects consist of the following components:</p><ul><li><p><code>peaks</code>: a character vector containing the names
of all peaks contained in the given cluster.</p></li>
<li><p><code>pval</code>: a numeric vector of length 1 containing
the bootstrap p-value (au) for the given cluster.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function to cluster peaks by spectral similarity. Before using this function,
reference spectra must be attached to the <code>peak_table</code> using the <code>
attach_ref_spectra</code> function. These reference spectra are then used to
construct a distance matrix based on spectral similarity (pearson correlation)
between peaks. Hierarchical clustering with bootstrap resampling is performed
on the resulting correlation matrix to classify peaks by spectral similarity,
as implemented in <code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>. Finally, bootstrap
values can be used to select clusters that exceed a certain confidence
threshold as defined by <code>alpha</code>.</p>
<p>Clusters can be filtered by the minimum and maximum size of the cluster using
the <code>min_size</code> and <code>max_size</code> arguments respectively. If
<code>max_only</code> is TRUE, only the largest cluster in a nested tree of
clusters meeting the specified confidence threshold will be returned.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>Users should be aware that the clustering algorithm will often return nested
clusters. Thus, an individual peak could appear in more than one cluster.</p></li>
<li><p>It is highly suggested to use more than 100 bootstraps if you run the
clustering algorithm on real data even though we use <code>nboot = 100</code> in
the example to reduce runtime. The authors of <code>pvclust</code> suggest <code>
nboot = 10000</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. Suzuki &amp; H. Shimodaira. 2006. Pvclust: an R package for assessing
the uncertainty in hierarchical clustering. <em>Bioinformatics</em>,
<b>22(12)</b>:1540-1542. <a href="https://doi.org/10.1093/bioinformatics/btl117" class="external-link">doi:10.1093/bioinformatics/btl117</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_warp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pk_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="attach_ref_spectra.html">attach_ref_spectra</a></span><span class="op">(</span><span class="va">pk_tab</span>, <span class="va">Sa_warp</span>, ref <span class="op">=</span> <span class="st">"max.int"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">cluster_spectra</span><span class="op">(</span><span class="va">pk_tab</span>, nboot <span class="op">=</span> <span class="fl">100</span>, max.only <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>save <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cluster_spectra-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

