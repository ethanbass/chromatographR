<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function to cluster peaks by spectral similarity. A representative spectrum
is selected for each peak in the provided peak table and used to construct a
distance matrix based on spectral similarity (pearson correlation) between
peaks. Currently, representative spectrum is just selected from the
chromatogram with the highest absorbance at lambda max. Hierarchical
clustering with bootstrap resampling is performed on the resulting
correlation matrix, as implemented in the
pvclust package. Bootstrap values can be used
to select clusters that exceed a certain confidence threshold as defined by
alpha."><title>Function to cluster peaks by spectral similarity. — cluster_spectra • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to cluster peaks by spectral similarity. — cluster_spectra"><meta property="og:description" content="Function to cluster peaks by spectral similarity. A representative spectrum
is selected for each peak in the provided peak table and used to construct a
distance matrix based on spectral similarity (pearson correlation) between
peaks. Currently, representative spectrum is just selected from the
chromatogram with the highest absorbance at lambda max. Hierarchical
clustering with bootstrap resampling is performed on the resulting
correlation matrix, as implemented in the
pvclust package. Bootstrap values can be used
to select clusters that exceed a certain confidence threshold as defined by
alpha."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/chromatographR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Function to cluster peaks by spectral similarity.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/HEAD/R/cluster_spectra.R" class="external-link"><code>R/cluster_spectra.R</code></a></small>
      <div class="d-none name"><code>cluster_spectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to cluster peaks by spectral similarity. A representative spectrum
is selected for each peak in the provided peak table and used to construct a
distance matrix based on spectral similarity (pearson correlation) between
peaks. Currently, representative spectrum is just selected from the
chromatogram with the highest absorbance at lambda max. Hierarchical
clustering with bootstrap resampling is performed on the resulting
correlation matrix, as implemented in the
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code> package. Bootstrap values can be used
to select clusters that exceed a certain confidence threshold as defined by
alpha.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">cluster_spectra</span><span class="op">(</span>
  <span class="va">peak_table</span>,
  <span class="va">chrom_list</span>,
  peak_no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">100</span><span class="op">)</span>,
  alpha <span class="op">=</span> <span class="fl">0.95</span>,
  nboot <span class="op">=</span> <span class="fl">1000</span>,
  plot_dend <span class="op">=</span> <span class="cn">TRUE</span>,
  plot_spectra <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  save <span class="op">=</span> <span class="cn">TRUE</span>,
  parallel <span class="op">=</span> <span class="cn">TRUE</span>,
  max.only <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>peak_table</dt>
<dd><p>Peak table from <code><a href="get_peaktable.html">get_peaktable</a></code>.</p></dd>
<dt>chrom_list</dt>
<dd><p>A list of chromatograms in matrix form (timepoints x
wavelengths).</p></dd>
<dt>peak_no</dt>
<dd><p>Minimum and maximum thresholds for the number of peaks a
cluster may have.</p></dd>
<dt>alpha</dt>
<dd><p>Confidence threshold for inclusion of cluster.</p></dd>
<dt>nboot</dt>
<dd><p>Number of bootstrap replicates for
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>
<dt>plot_dend</dt>
<dd><p>Logical. If TRUE, plots dendrogram with bootstrap values.</p></dd>
<dt>plot_spectra</dt>
<dd><p>Logical. If TRUE, plots overlapping spectra for each
cluster.</p></dd>
<dt>verbose</dt>
<dd><p>Logical. If TRUE, prints progress report to console.</p></dd>
<dt>save</dt>
<dd><p>Logical. If TRUE, saves pvclust object to current directory.</p></dd>
<dt>parallel</dt>
<dd><p>Logical. If TRUE, use parallel processing for
<code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>
<dt>max.only</dt>
<dd><p>Logical. If TRUE, returns only highest level for nested
dendrograms.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments to <code><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns S4 "cluster" object with the following components:</p>
<dl><dt>peaks</dt>
<dd><p>a character vector containing the names of all peaks contained
in the given cluster.</p></dd>
<dt>pval</dt>
<dd><p>a numeric vector of length 1 containing
the bootstrap p-value (au) for the given cluster.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. Suzuki, H. Shimodaira: Pvclust: an R package for assessing
the uncertainty in hierarchical clustering. Bioinformatics, 22-12:1540-1542
(2006). <a href="https://doi.org/10.1093/bioinformatics/btl117" class="external-link">doi:10.1093/bioinformatics/btl117</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_warp</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">cluster_spectra</span><span class="op">(</span><span class="va">pk_tab</span>, nboot<span class="op">=</span><span class="fl">100</span>, max.only <span class="op">=</span> <span class="cn">FALSE</span>, save <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">.97</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "...collecting representative spectra"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "...clustering spectra"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Creating a temporary cluster...done:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> socket cluster with 1 nodes on host ‘localhost’</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Cluster size is too small (or NULL). non-parallel version is executed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 0.5)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 0.6)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 0.7)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 0.8)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 0.9)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 1.0)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 1.1)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 1.2)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 1.3)... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap (r = 1.4)... Done.</span>
<span class="r-plt img"><img src="cluster_spectra-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "...plotting clustered spectra"</span>
<span class="r-plt img"><img src="cluster_spectra-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="cluster_spectra-8.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

