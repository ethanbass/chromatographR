<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian profile — fit_peaks • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian profile — fit_peaks"><meta name="description" content="Fit peak parameters using exponential-gaussian hybrid or gaussian function."><meta property="og:description" content="Fit peak parameters using exponential-gaussian hybrid or gaussian function."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/chromatographR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/GC-FID.html">Analysis of *Polistes* cuticular hydrocarbons with GC-FID</a></li>
    <li><a class="dropdown-item" href="../articles/uv_spectra.html">Programmatic analysis of UV spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian profile</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/master/R/fit_peaks.R" class="external-link"><code>R/fit_peaks.R</code></a></small>
      <div class="d-none name"><code>fit_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit peak parameters using exponential-gaussian hybrid or gaussian function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_peaks</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd.max <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"egh"</span>, <span class="st">"gaussian"</span>, <span class="st">"raw"</span><span class="op">)</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  estimate_purity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  noise_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A chromatogram in matrix format.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Wavelength to fit peaks at.</p></dd>


<dt id="arg-pos">pos<a class="anchor" aria-label="anchor" href="#arg-pos"></a></dt>
<dd><p>Locations of peaks in vector y. If NULL, <code>find_peaks</code> will
run automatically to find peak positions.</p></dd>


<dt id="arg-sd-max">sd.max<a class="anchor" aria-label="anchor" href="#arg-sd-max"></a></dt>
<dd><p>Maximum width (standard deviation) for peaks. Defaults to 50.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>Function for peak fitting. (Currently exponential-gaussian hybrid
<code>egh</code>, <code>gaussian</code> and <code>raw</code> settings are supported). If <code>
raw</code> is selected, trapezoidal integration will be performed on raw data
without fitting a peak shape. Defaults to <code>egh</code>.)</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum number of iterations to use in nonlinear least
squares peak-fitting. (Defaults to 1000).</p></dd>


<dt id="arg-estimate-purity">estimate_purity<a class="anchor" aria-label="anchor" href="#arg-estimate-purity"></a></dt>
<dd><p>Logical. Whether to estimate purity or not. Defaults
to TRUE.</p></dd>


<dt id="arg-noise-threshold">noise_threshold<a class="anchor" aria-label="anchor" href="#arg-noise-threshold"></a></dt>
<dd><p>Noise threshold. Input to <code>get_purity</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to <code>find_peaks</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>fit_peaks</code> function returns a matrix, whose columns contain
the following information about each peak:</p>
<dl><dt>rt</dt>
<dd><p>Location of the peak maximum.</p></dd>

<dt>start</dt>
<dd><p>Start of peak (only included in table if <code>bounds = TRUE</code>).</p></dd>

<dt>end</dt>
<dd><p>End of peak (only included in table if <code>bounds = TRUE</code>).</p></dd>

<dt>sd</dt>
<dd><p>The standard deviation of the peak.</p></dd>

<dt>tau</dt>
<dd><p>\(\tau\) parameter (only included in table if <code>fit = "egh"</code>).</p></dd>

<dt>FWHM</dt>
<dd><p>The full width at half maximum.</p></dd>

<dt>height</dt>
<dd><p>Peak height.</p></dd>

<dt>area</dt>
<dd><p>Peak area.</p></dd>

<dt>r.squared</dt>
<dd><p>The R-squared value for linear fit of the model to the data.</p></dd>

<dt>purity</dt>
<dd><p>The spectral purity of peak as assessed by <code><a href="get_purity.html">get_purity</a></code>.</p></dd>

</dl><p>Again, the first five elements (rt, start, end, sd and FWHM) are expressed
as indices, so not in terms of the real retention times. The transformation
to "real" time is done in function <code>get_peaks</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Peak parameters are calculated by fitting the data
to a gaussian or exponential-gaussian hybrid curve using non-linear least
squares estimation as implemented in <code><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">nlsLM</a></code>.
The area under the fitted curve is then estimated using trapezoidal
approximation.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>fit_peaks</code> function is adapted from Dr. Robert
Morrison's
<a href="https://github.com/robertdouglasmorrison/DuffyTools" class="external-link">DuffyTools package</a>
as well as code published in Ron Wehrens'
<a href="https://github.com/rwehrens/alsace" class="external-link">alsace</a> package.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Lan, K. &amp; Jorgenson, J. W. 2001. A hybrid of exponential and gaussian
functions as a simple model of asymmetric chromatographic peaks. <em>Journal of
Chromatography A</em> <b>915</b>:1-13. <a href="https://doi.org/10.1016/S0021-9673%2801%2900594-5" class="external-link">doi:10.1016/S0021-9673(01)00594-5</a>
.</p></li>
<li><p>Naish, P. J. &amp; Hartwell, S. 1988. Exponentially Modified Gaussian functions - A
good model for chromatographic peaks in isocratic HPLC? <em>Chromatographia</em>,
<b>26</b>: 285-296. <a href="https://doi.org/10.1007/BF02268168" class="external-link">doi:10.1007/BF02268168</a>
.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="find_peaks.html">find_peaks</a></code>, <code><a href="get_peaks.html">get_peaks</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_peaks</span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="fl">220</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           rt start end        sd           tau      FWHM      height</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   30.69332    14  46 6.2865644    1.20769992 14.773426   8.9910726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   50.94330    46  52 0.5711967  -11.41366848  1.342312   0.3652505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   61.44532    53  61 3.2042222    2.37308275  7.529922  12.7874585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   69.97526    61  78 2.7067311   -1.01879444  6.360818 118.1461826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   82.42709    78  85 1.3744994   -0.73109961  3.230074   1.5745430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   89.64284    85  93 1.5296385    0.61202488  3.594650   2.3360448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  104.49707    93 114 2.1826134   -0.19394678  5.129142 878.3558848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   81.84177   114 118 2.4690722   22.61770113  5.802320   9.6411867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  119.85327   118 123 5.2832737  -13.86056689 12.415693   8.5707183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 131.85675   123 139 1.8315236    0.11513594  4.304081 418.7796260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 141.10828   139 147 4.1299082   -4.37157201  9.705284   8.5085781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 156.09501   149 161 1.7963783   -0.01487998  4.221489   5.8543152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 167.73853   161 171 1.6517982   -0.14556475  3.881726  25.5505898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 183.22815   171 188 2.0807233   -0.22145455  4.889700 350.1547326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 193.98654   188 200 2.4682084   -1.29245512  5.800290 119.6729349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 216.44045   200 228 1.8375563   -0.13007408  4.318257 319.6260534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 234.50440   228 238 1.9619252   -0.17648212  4.610524  35.8686113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 243.58113   238 254 4.9483859    0.66568143 11.628707  15.8252538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 262.00099   254 264 1.8302984   -0.98597515  4.301201  17.3957395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 272.87432   264 279 3.0837104    0.05107119  7.246719  96.9289225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 284.45995   279 293 1.8712197   -0.34947351  4.397366 121.3286776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 298.28530   293 303 2.0217365   -0.90317976  4.751081  14.6884289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 320.15708   315 323 1.2587749    0.34042184  2.958121   0.6212100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 336.89949   323 347 2.2339189   -0.82019092  5.249709 157.2481960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 351.82167   347 363 4.3854006    2.73641711 10.305691   7.1109632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 379.01651   363 383 9.6193330  -13.36671566 22.605432   3.8470521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 389.96461   383 390 0.4505398  -11.19848606  1.058768   5.0689224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 396.32753   390 401 7.3086188   -2.14825864 17.175254   6.6276427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 410.94947   401 411 1.7808715 -123.44165218  4.185048   5.5950637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 419.42472   411 421 4.8293966  -14.83514636 11.349082   7.4589610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           area r.squared     purity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   141.609052 0.9869708 0.63636364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.533815 0.7267476 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    44.203814 0.9997068 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   844.468381 0.9954198 0.17647059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     7.929626 0.9529150 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     9.913595 0.9974965 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  4895.362421 0.9991512 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    37.726631 0.8292605 0.60000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    36.686028 0.9637970 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2149.825149 0.9991802 0.15384615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   42.867284 0.9910774 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   31.941462 0.9960339 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  116.325582 0.9997472 0.90909091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2159.863516 0.9987345 0.15384615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  749.502596 0.9870224 0.18181818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 1996.653868 0.9988400 0.50000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  231.767485 0.9889112 0.72727273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  148.058988 0.8325459 0.52941176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   88.004196 0.9912112 0.63636364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  713.899661 0.9118992 0.46666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  753.063438 0.9843055 0.26666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   84.486071 0.9455491 0.72727273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    2.923839 0.9897500 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  972.579141 0.9950354 0.33333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   70.695956 0.7701393 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   63.752468 0.9955775 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   30.677295 0.9392470 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   64.992481 0.8411157 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   54.963920 0.8662737 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   67.504644 0.8950062 1.00000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

