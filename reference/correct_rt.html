<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Aligns chromatograms using parametric time warping, as
implemented in ptw, or variable penalty dynamic
time warping, as implemented in VPdtw. The
init.coef and n.traces arguments apply only to ptw
warping, while penalty and maxshift apply only to vpdtw
warping."><title>Correct retention time — correct_rt • chromatographR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correct retention time — correct_rt"><meta property="og:description" content="Aligns chromatograms using parametric time warping, as
implemented in ptw, or variable penalty dynamic
time warping, as implemented in VPdtw. The
init.coef and n.traces arguments apply only to ptw
warping, while penalty and maxshift apply only to vpdtw
warping."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/chromatographR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Correct retention time</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/HEAD/R/correct_rt.R" class="external-link"><code>R/correct_rt.R</code></a></small>
      <div class="d-none name"><code>correct_rt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aligns chromatograms using parametric time warping, as
implemented in <code><a href="https://rdrr.io/pkg/ptw/man/ptw.html" class="external-link">ptw</a></code>, or variable penalty dynamic
time warping, as implemented in <code><a href="https://rdrr.io/pkg/VPdtw/man/VPdtw.html" class="external-link">VPdtw</a></code>. The
<code>init.coef</code> and <code>n.traces</code> arguments apply only to <code>ptw</code>
warping, while <code>penalty</code> and <code>maxshift</code> apply only to <code>vpdtw</code>
warping.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">correct_rt</span><span class="op">(</span></span>
<span>  <span class="va">chrom_list</span>,</span>
<span>  <span class="va">lambdas</span>,</span>
<span>  models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reference <span class="op">=</span> <span class="st">"best"</span>,</span>
<span>  alg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ptw"</span>, <span class="st">"vpdtw"</span><span class="op">)</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corrected.values"</span>, <span class="st">"models"</span><span class="op">)</span>,</span>
<span>  init.coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  n.traces <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.zeros <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trwdth <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  plot_it <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  maxshift <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>chrom_list</dt>
<dd><p>List of chromatograms in matrix format.</p></dd>


<dt>lambdas</dt>
<dd><p>Select wavelengths to use by name.</p></dd>


<dt>models</dt>
<dd><p>List of models to warp by. The models provided here (if any)
must match the algorithm selected in <code>alg</code>.</p></dd>


<dt>reference</dt>
<dd><p>Index of the sample that is to be considered the reference
sample.</p></dd>


<dt>alg</dt>
<dd><p>algorithm to use: parametric time warping (<code>ptw</code>) or variable
penalty dynamic time warping (<code>vpdtw</code>).</p></dd>


<dt>what</dt>
<dd><p>What to return: either the 'corrected.values' (useful for visual
inspection) or the warping 'models' (for further programmatic use).</p></dd>


<dt>init.coef</dt>
<dd><p>Starting values for the optimization.</p></dd>


<dt>n.traces</dt>
<dd><p>Number of traces to use.</p></dd>


<dt>n.zeros</dt>
<dd><p>Number of zeros to add.</p></dd>


<dt>scale</dt>
<dd><p>Logical. If true, scale chromatograms before warping.</p></dd>


<dt>trwdth</dt>
<dd><p>width of the triangle in the WCC criterion.</p></dd>


<dt>plot_it</dt>
<dd><p>Logical. Whether to plot alignment.</p></dd>


<dt>penalty</dt>
<dd><p>The divisor used to calculate the penalty for
<code><a href="https://rdrr.io/pkg/VPdtw/man/VPdtw.html" class="external-link">VPdtw</a></code>. The warping penalty is calculated by dividing the
<code><a href="https://rdrr.io/pkg/VPdtw/man/dilation.html" class="external-link">dilation</a></code> by this number. Thus, a higher number will
produce a lower penalty and be more permissive, while a lower number will
produce a higher penalty and allow less warping. Defaults to 5.</p></dd>


<dt>maxshift</dt>
<dd><p>Integer. Maximum allowable shift for <code><a href="https://rdrr.io/pkg/VPdtw/man/VPdtw.html" class="external-link">VPdtw</a></code>.
Defaults to 50.</p></dd>


<dt>verbose</dt>
<dd><p>Whether to print verbose output.</p></dd>


<dt>show_progress</dt>
<dd><p>Logical. Whether to show progress bar. Defaults to
<code>TRUE</code> if <code><a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply</a></code> is installed. Currently works
only for <code>ptw</code> alignments.</p></dd>


<dt>cl</dt>
<dd><p>Argument to <code><a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pblapply</a></code> or <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code>.
Either an integer specifying the number of clusters to use for parallel
processing or a cluster object created by <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code>.
Defaults to 2. On Windows integer values will be ignored.</p></dd>


<dt>...</dt>
<dd><p>Optional arguments for the <code><a href="https://rdrr.io/pkg/ptw/man/ptw.html" class="external-link">ptw</a></code> function.
The only argument that cannot be changed is <code>warp.type</code>: this is always
equal to <code>"global"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of warping models or a list of warped absorbance profiles,
depending on the value of the <code>what</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Adapted from
<a href="https://github.com/rwehrens/alsace/blob/master/R/correctRT.R" class="external-link">correctRT</a>
function in the alsace package by Ron Wehrens.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Clifford, D., Stone, G., Montoliu, I., Rezzi, S., Martin, F. P., Guy, P.,
Bruce, S., &amp; Kochhar, S. 2009. Alignment using variable penalty dynamic time
warping. <em>Analytical chemistry</em>, <b>81(3)</b>:1000-1007. <a href="https://doi.org/10.1021/ac802041e" class="external-link">doi:10.1021/ac802041e</a>
.</p></li>
<li><p>Clifford, D., &amp; Stone, G. 2012. Variable Penalty Dynamic Time Warping Code
for Aligning Mass Spectrometry Chromatograms in R. <em>Journal of
Statistical Software</em>, <b>47(8)</b>:1-17. <a href="https://doi.org/10.18637/jss.v047.i08" class="external-link">doi:10.18637/jss.v047.i08</a>
.</p></li>
<li><p>Eilers, P.H.C. 2004. Parametric Time Warping.
<em>Anal. Chem.</em>, <b>76</b>:404-411. <a href="https://doi.org/10.1021/ac034800e" class="external-link">doi:10.1021/ac034800e</a>
.</p></li>
<li><p>Wehrens, R., Bloemberg, T.G., and Eilers P.H.C. 2015. Fast
parametric time warping of peak lists. <em>Bioinformatics</em>,
<b>31</b>:3063-3065. <a href="https://doi.org/10.1093/bioinformatics/btv299" class="external-link">doi:10.1093/bioinformatics/btv299</a>
.</p></li>
<li><p>Wehrens, R., Carvalho, E., Fraser, P.D. 2015. Metabolite profiling in
LC–DAD using multivariate curve resolution: the alsace package for R. <em>
Metabolomics</em>, <b>11</b>:143-154. <a href="https://doi.org/10.1007/s11306-014-0683-5" class="external-link">doi:10.1007/s11306-014-0683-5</a>
.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ptw/man/ptw.html" class="external-link">ptw</a></code>, <code><a href="correct_peaks.html">correct_peaks</a></code>,
<code><a href="https://rdrr.io/pkg/VPdtw/man/VPdtw.html" class="external-link">VPdtw</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># interactive()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">warping.models</span> <span class="op">&lt;-</span> <span class="fu">correct_rt</span><span class="op">(</span><span class="va">Sa_pr</span>, what <span class="op">=</span> <span class="st">"models"</span>, lambdas<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"210"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">warp</span> <span class="op">&lt;-</span> <span class="fu">correct_rt</span><span class="op">(</span>chrom_list <span class="op">=</span> <span class="va">Sa_pr</span>, models <span class="op">=</span> <span class="va">warping.models</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

