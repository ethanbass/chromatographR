<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find peaks — find_peaks • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find peaks — find_peaks"><meta name="description" content="Detects peaks in chromatographic profile."><meta property="og:description" content="Detects peaks in chromatographic profile."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/chromatographR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/GC-FID.html">Analysis of *Polistes* cuticular hydrocarbons with GC-FID</a></li>
    <li><a class="dropdown-item" href="../articles/uv_spectra.html">Programmatic analysis of UV spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Find peaks</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/dev/R/fit_peaks.R" class="external-link"><code>R/fit_peaks.R</code></a></small>
      <div class="d-none name"><code>find_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Detects peaks in chromatographic profile.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_peaks</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  smooth_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"box"</span>, <span class="st">"savgol"</span>, <span class="st">"mva"</span>, <span class="st">"tmva"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  smooth_window <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  slope_thresh <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  amp_thresh <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bounds <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Signal (as a numerical vector).</p></dd>


<dt id="arg-smooth-type">smooth_type<a class="anchor" aria-label="anchor" href="#arg-smooth-type"></a></dt>
<dd><p>Type of smoothing. Either gaussian kernel (<code>"gaussian"</code>),
box kernel (<code>"box"</code>), savitzky-golay smoothing (<code>"savgol"</code>),
moving average (<code>"mva"</code>), triangular moving average (<code>"tmva"</code>), or
no smoothing (<code>"none"</code>).</p></dd>


<dt id="arg-smooth-window">smooth_window<a class="anchor" aria-label="anchor" href="#arg-smooth-window"></a></dt>
<dd><p>Smoothing window. Larger values of this parameter will
exclude sharp, narrow features. If the supplied value is between 0 and
1, window will be interpreted as a proportion of points to include. Otherwise,
the window will be the absolute number of points to include in the window.
(Defaults to <code>.001</code>).</p></dd>


<dt id="arg-slope-thresh">slope_thresh<a class="anchor" aria-label="anchor" href="#arg-slope-thresh"></a></dt>
<dd><p>Minimum threshold for slope of the smoothed first
derivative. This parameter filters on the basis of peak width, such that
larger values will exclude broad peaks from the peak list. (Defaults to
<code>0</code>).</p></dd>


<dt id="arg-amp-thresh">amp_thresh<a class="anchor" aria-label="anchor" href="#arg-amp-thresh"></a></dt>
<dd><p>Minimum threshold for peak amplitude. This parameter
filters on the basis of peak height, such that larger values will
exclude small peaks from the peak list. (Defaults to <code>0</code>).</p></dd>


<dt id="arg-bounds">bounds<a class="anchor" aria-label="anchor" href="#arg-bounds"></a></dt>
<dd><p>Logical. If TRUE, includes peak boundaries in data.frame.
(Defaults to <code>TRUE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>bounds == TRUE</code>, returns a data.frame containing the center,
start, and end of each identified peak. Otherwise, returns a numeric vector
of peak centers. All locations are expressed as indices.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Detects peaks by looking for zero-crossings in the smoothed first derivative of
the signal (<code>y</code>) that exceed the specified slope threshold
(<code>slope_thresh</code>). Additionally, peaks can be filtered by supplying a minimal
amplitude threshold (<code>amp_thresh</code>), filtering out peaks below the
specified height. Smoothing is intended to prevent the algorithm from
getting caught up on local minima and maxima that do not represent true
features. Several smoothing options are available, including <code>"gaussian"</code>,
box kernel (<code>"box"</code>), savitzky-golay smoothing (<code>"savgol"</code>),
moving average (<code>"mva"</code>), triangular moving average (<code>"tmva"</code>), or
no smoothing (<code>"none"</code>).</p>
<p>It is recommended to do pre-processing using the <code><a href="preprocess.html">preprocess</a></code>
function before peak detection. Overly high chromatographic resolution can
sometimes cause peaks to be split into multiple segments. In this case,
it is recommended to increase the <code>smooth_window</code> or reduce the
resolution along the time axis by adjusting the <code>dim1</code> argument during
preprocessing.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>find_peaks</code> function is adapted from MATLAB code included in
Prof. Tom O'Haver's
<a href="http://terpconnect.umd.edu/~toh/spectrum/PeakFindingandMeasurement.htm" class="external-link">
Pragmatic Introduction to Signal Processing</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>O'Haver, Tom. Pragmatic Introduction to Signal Processing:
Applications in scientific measurement. <a href="https://terpconnect.umd.edu/~toh/spectrum/" class="external-link">https://terpconnect.umd.edu/~toh/spectrum/</a>
(Accessed January, 2022).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fit_peaks.html">fit_peaks</a></code>, <code><a href="get_peaks.html">get_peaks</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">find_peaks</span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="st">"220"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pos lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   28    14    46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   49    46    52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   60    53    61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   69    61    78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   81    78    85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   89    85    93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  104    93   114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  115   114   118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  120   118   123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 131   123   139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 141   139   147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 155   149   161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 167   161   171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 182   171   188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 193   188   200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 215   200   228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 233   228   238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 243   238   254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 261   254   264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 272   264   279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 283   279   293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 297   293   303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 305   303   309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 319   315   323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 336   323   347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 351   347   363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 378   363   383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 388   383   390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 395   390   401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 408   401   411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 417   411   421</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

