<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combine peaks — combine_peaks • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combine peaks — combine_peaks"><meta name="description" content="Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(tol) for retention time matching and minimum spectral correlation
(min.cor) for a match."><meta property="og:description" content="Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(tol) for retention time matching and minimum spectral correlation
(min.cor) for a match."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/chromatographR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/GC-FID.html">Analysis of *Polistes* cuticular hydrocarbons with GC-FID</a></li>
    <li><a class="dropdown-item" href="../articles/uv_spectra.html">Programmatic analysis of UV spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Combine peaks</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/master/R/combine_peaks.R" class="external-link"><code>R/combine_peaks.R</code></a></small>
      <div class="d-none name"><code>combine_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(<code>tol</code>) for retention time matching and minimum spectral correlation
(<code>min.cor</code>) for a match.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combine_peaks</span><span class="op">(</span></span>
<span>  <span class="va">peak_table</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  min.cor <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  choose <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-peak-table">peak_table<a class="anchor" aria-label="anchor" href="#arg-peak-table"></a></dt>
<dd><p>Peak table from <code><a href="get_peaktable.html">get_peaktable</a></code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Tolerance for matching retention times (maximum retention time
difference). Defaults to <code>.01</code>.</p></dd>


<dt id="arg-min-cor">min.cor<a class="anchor" aria-label="anchor" href="#arg-min-cor"></a></dt>
<dd><p>Minimum spectral correlation to confirm a match. Defaults to
<code>0.9</code>.</p></dd>


<dt id="arg-choose">choose<a class="anchor" aria-label="anchor" href="#arg-choose"></a></dt>
<dd><p>If <code>max</code> will retain peak with highest intensity. Otherwise,
the first column in the data.frame will be retained.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Whether to print status to the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A peak table similar to the input peak table, but with duplicate
columns combined according to the specified criteria.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_peaks.html">get_peaks</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_warp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pk_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="attach_ref_spectra.html">attach_ref_spectra</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">combine_peaks</span><span class="op">(</span><span class="va">pk_tab</span>, tol <span class="op">=</span> <span class="fl">.02</span>, min.cor <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V1       V2        V3        V4       V5        V6       V7        V8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.000000 5.111190 0.0000000 0.5864823 1.858693 15.079233 0.000000 0.4135257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.000000 4.033081 0.9163944 0.5221266 0.000000  7.705485 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 3.368245 8.228498 0.9735932 0.0000000 1.963956 25.888893 0.000000 1.8394472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 0.000000 5.655876 1.8309616 0.0000000 1.735467 14.650605 1.459654 0.3488550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            V9      V10      V11      V12       V13      V14      V15       V16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119  79.71546 2.637016 41.60604 1.724824 1.3743838 2.273449 36.58533 15.189655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  57.27332 1.042586 18.33105 0.000000 0.8614246 7.504094 20.56684  8.879872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122  59.62042 1.417466 35.83855 0.000000 1.2422142 4.241067 31.60616 12.910084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 108.93550 4.157266 33.22952 3.405194 3.1656321 5.231752 42.99198 23.968663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          V17      V18      V19       V20       V21      V22       V23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 33.71629 4.186043 3.890605 1.7999191 12.435065 15.09572 2.5155590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 22.59679 1.169449 1.750044 0.1143296  6.619292 12.54686 0.7921663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 28.40685 2.232165 3.037413 0.4855545  7.976247 14.88744 2.7807659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 25.33267 5.011990 5.348641 0.2741214 12.648599 15.42859 2.3459283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            V24        V25      V26       V27       V28       V29       V30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.00000000 0.11261310 17.80024 2.0024282 0.0000000 0.7981487 0.8774407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.01374328 0.43874747 14.41614 0.6184847 0.5505384 0.4542899 0.5315334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 0.01900430 0.11078837 16.60867 0.9699587 1.2199894 1.2251103 0.8634827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 0.00512731 0.02601551 24.77821 1.0894581 1.0049019 1.5687582 1.7486409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          V31      V32      V33       V34       V35       V36       V39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 1.819662 1.023753 1.541590 0.0000000 0.2105941 0.5041651 0.1046104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 1.085835 0.000000 1.811022 0.0000000 0.5440478 0.2934669 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 1.288960 0.000000 4.117218 0.1280478 0.5797748 0.3649663 0.3733894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 1.459723 1.647317 3.730485 0.2736762 0.7127212 0.6514810 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            V40       V42       V43        V44       V46      V49       V50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.09932078 0.2558299 14.841595 0.00000000 0.8899389 16.64689 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.18110972 0.0000000  6.941289 0.03897730 1.8268337 11.45662 0.1379431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 0.00000000 0.3773357 14.120471 0.03016515 1.7424893 14.23811 0.7083038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 0.07382435 0.7167379 11.020983 0.53962131 0.7439920 12.98416 0.6251158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V52      V54      V55         V57         V58       V60       V62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 1.1409371 5.373707 6.566692 0.000000000 0.059937260 0.1983225 0.3076778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.4724857 2.819725 5.966240 0.002892882 0.023415605 0.1066713 0.1992947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 1.1684493 3.438104 7.081215 0.004187678 0.041697073 0.2845064 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 1.6551325 5.200684 7.292224 0.023957666 0.005351955 0.2704478 0.3774084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V63       V64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.6844486 0.5443093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.9549370 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 0.9325107 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 0.5895916 0.6156869</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

