<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combine peaks — combine_peaks • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combine peaks — combine_peaks"><meta name="description" content="Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(tol) for retention time matching and minimum spectral correlation
(min.cor) for a match."><meta property="og:description" content="Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(tol) for retention time matching and minimum spectral correlation
(min.cor) for a match."><meta property="og:image" content="https://ethanbass.github.io/chromatographR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/chromatographR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Combine peaks</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/master/R/combine_peaks.R" class="external-link"><code>R/combine_peaks.R</code></a></small>
      <div class="d-none name"><code>combine_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Utility function to combine duplicate peaks in peak table, i.e. peaks that
were integrated at more than one wavelength or component. Specify tolerance
(<code>tol</code>) for retention time matching and minimum spectral correlation
(<code>min.cor</code>) for a match.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combine_peaks</span><span class="op">(</span></span>
<span>  <span class="va">peak_table</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  min.cor <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  choose <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-peak-table">peak_table<a class="anchor" aria-label="anchor" href="#arg-peak-table"></a></dt>
<dd><p>Peak table from <code><a href="get_peaktable.html">get_peaktable</a></code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Tolerance for matching retention times (maximum retention time
difference). Defaults to <code>.01</code>.</p></dd>


<dt id="arg-min-cor">min.cor<a class="anchor" aria-label="anchor" href="#arg-min-cor"></a></dt>
<dd><p>Minimum spectral correlation to confirm a match. Defaults to
<code>0.9</code>.</p></dd>


<dt id="arg-choose">choose<a class="anchor" aria-label="anchor" href="#arg-choose"></a></dt>
<dd><p>If <code>max</code> will retain peak with highest intensity. Otherwise,
the first column in the data.frame will be retained.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Whether to print status to the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A peak table similar to the input peak table, but with duplicate
columns combined according to the specified criteria.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_peaks.html">get_peaks</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_warp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pk_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="attach_ref_spectra.html">attach_ref_spectra</a></span><span class="op">(</span><span class="va">pk_tab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">combine_peaks</span><span class="op">(</span><span class="va">pk_tab</span>, tol <span class="op">=</span> <span class="fl">.02</span>, min.cor <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V1        V2        V3       V4        V5        V6        V7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 547.5999   0.00000  64.73611 188.9210 1514.4775  31.08266  7972.271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 426.2768 109.41736  61.30032   0.0000  800.6312   0.00000  5742.089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 839.5934  94.67302 199.57845   0.0000 2595.0200 179.59510  5966.168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 620.1729 228.73095 198.89770 530.8515 1399.5000  28.75473 10987.963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V8       V9      V10       V11      V12      V13       V14      V15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 241.2644 4141.194 158.2482 147.14305 228.2495 3616.648 1406.7510 3251.616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  94.9273 1811.813   0.0000  81.06425 758.0809 1998.574  849.7337 2209.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 136.7419 3567.244   0.0000 112.02525 402.7496 3061.476 1147.1180 2717.260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 362.4412 3319.526 346.4913 312.67651 539.1735 4205.752 2360.5469 2455.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          V16      V17      V18        V19       V20      V21       V22      V23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119  0.00000 343.0051 296.6922 113.243756 1147.1798 1384.080 220.73047 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  0.00000 101.5689 161.9159   8.007096  656.8275 1189.811  83.93586 5.515938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 79.15089 159.8489 244.1269  36.488943  795.4071 1427.085 275.36463 5.266083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 42.90218 445.4984 454.3478  16.246979 1202.3318 1478.686 229.99456 2.937198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V24       V25      V26       V27      V28      V29      V30      V31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.7932897 15.283759 1703.289 156.39972  0.00000 49.41934 32.37732 71.26704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.0000000 41.785287 1365.711  34.63006 18.39123 14.90621 15.30085 28.80203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 0.0000000 11.908741 1589.343  71.47440 37.85030 19.71575 20.80656 23.50600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 3.5934152  2.675703 2324.971  47.70708 26.21671 41.10378 28.37305 13.11958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V32      V33      V34      V35      V36      V37        V38       V39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 18.098750 34.32758 24.20533  0.00000 40.94460 66.63341   1.560411  628.8432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  0.000000 25.78324  0.00000  0.00000 58.29037 35.70237   0.000000  313.3893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122  4.146413 88.99537  0.00000 17.72865 63.09756 40.62970  30.633681 1083.3709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 21.856280 39.24938  0.00000 30.85831 80.37326 77.24610 134.060160  634.5378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V40       V41       V45      V50       V51      V52      V57      V58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119  5.954668  3.185244 26.855908 1594.504 181.23686 68.35036 0.000000 6.765074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  0.000000 17.384465  4.328725 1107.869  46.57830 34.55536 1.169725 3.267406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 34.168541  0.000000  2.934368 1369.448  94.47697 88.13190 1.348439 4.906127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458  0.000000  5.334132 58.508031 1217.711 254.76091 97.89059 4.839070 1.766295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           V60      V61      V62       V67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 10.825399 5.025003 2.659547  9.931884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121  5.880129 0.000000 6.603921  7.197999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 14.487687 2.717955 2.681821 19.382161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 458 11.990751 6.853318 8.433412 21.058001</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

