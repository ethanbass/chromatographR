<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit peak parameters using exponential-gaussian hybrid or gaussian function."><title>Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian
profile — fit_peaks • chromatographR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian
profile — fit_peaks"><meta property="og:description" content="Fit peak parameters using exponential-gaussian hybrid or gaussian function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chromatographR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/chromatographR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ethanbass/chromatographR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit chromatographic peaks to an exponential-gaussian hybrid or gaussian
profile</h1>
      <small class="dont-index">Source: <a href="https://github.com/ethanbass/chromatographR/blob/HEAD/R/fit_peaks.R" class="external-link"><code>R/fit_peaks.R</code></a></small>
      <div class="d-none name"><code>fit_peaks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit peak parameters using exponential-gaussian hybrid or gaussian function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fit_peaks</span><span class="op">(</span>
  <span class="va">y</span>,
  pos <span class="op">=</span> <span class="cn">NULL</span>,
  sd.max <span class="op">=</span> <span class="fl">50</span>,
  fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"egh"</span>, <span class="st">"gaussian"</span><span class="op">)</span>,
  max.iter <span class="op">=</span> <span class="fl">1000</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p>response (numerical vector)</p></dd>
<dt>pos</dt>
<dd><p>Locations of peaks in vector y. If NULL, <code>find_peaks</code> will
run automatically to find peak positions.</p></dd>
<dt>sd.max</dt>
<dd><p>Maximum width (standard deviation) for peaks. Defaults to 50.</p></dd>
<dt>fit</dt>
<dd><p>Function for peak fitting. (Currently "gaussian" and exponential
gaussian hybrid ("egh") are supported. Defaults to egh.)</p></dd>
<dt>max.iter</dt>
<dd><p>Maximum number of iterations to use in nonlinear least
squares peak-fitting. (Defaults to 1000).</p></dd>
<dt>...</dt>
<dd><p>Additional arguments to <code>find_peaks</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>fit_peaks</code> returns a matrix, whose columns contain
the following information:</p>
<dl><dt>rt</dt>
<dd><p>location of the maximum of the peak
(x)</p></dd>
<dt>start</dt>
<dd><p>start of peak (only included in table if `bounds==TRUE`)</p></dd>
<dt>end</dt>
<dd><p>end of peak (only included in table if `bounds==TRUE`)</p></dd>
<dt>sd</dt>
<dd><p>width of the peak (x)</p></dd>
<dt>tau</dt>
<dd><p>tau parameter (only included in
table if `fit=="egh"`)</p></dd>
<dt>FWHM</dt>
<dd><p>full width at half maximum (x)</p></dd>
<dt>height</dt>
<dd><p>height of the peak (y)</p></dd>
<dt>area</dt>
<dd><p>peak area</p></dd>
<dt>r.squared</dt>
<dd><p>r-squared value for linear fit of model to data.</p></dd>
</dl><p>Again, the first five elements (rt, start, end, sd and FWHM) are expressed
as indices, so not in terms of the real retention times. The transformation
to "real" time is done in function <code>get_peaks</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Peak parameters are calculated using <code>fit_peaks</code>, which fits the data
to a gaussian or exponential-gaussian hybrid curve using non-linear least
squares estimation as implemented in <code><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">nlsLM</a></code>.
Area under the fitted curve is estimated using trapezoidal estimation.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>fit_peaks</code> function is adapted from Dr. Robert
Morrison's
<a href="https://github.com/robertdouglasmorrison/DuffyTools" class="external-link">DuffyTools package</a>
as well as code published in Ron Wehrens'
<a href="https://github.com/rwehrens/alsace" class="external-link">alsace</a> package.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lan, K. &amp; Jorgenson, J. W. A hybrid of exponential and gaussian
functions as a simple model of asymmetric chromatographic peaks. Journal of
Chromatography A 915, 1-13 (2001).
Naish, P. J. &amp; Hartwell, S. Exponentially Modified Gaussian functions - A
good model for chromatographic peaks in isocratic HPLC? Chromatographia 26,
285-296 (1988).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="find_peaks.html">find_peaks</a></code>, <code><a href="get_peaks.html">get_peaks</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ethan Bass</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">fit_peaks</span><span class="op">(</span><span class="va">Sa_pr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="st">"220"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           rt start end        sd           tau      FWHM      height</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   30.69582    15  46 6.2876089    1.20032657 14.775881   8.9910726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   50.87252    46  51 0.8609421  -11.40884987  2.023214   0.3652505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   61.44532    54  61 3.2042224    2.37308316  7.529923  12.7874585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   69.97526    61  78 2.7067311   -1.01879444  6.360818 118.1461826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   82.39452    78  84 1.3890785   -0.62739645  3.264334   1.5745430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   89.64284    85  93 1.5296385    0.61202489  3.594650   2.3360448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  104.49707    93 114 2.1826134   -0.19394681  5.129142 878.3558848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   81.85278   114 118 2.4020261   22.61826109  5.644761   9.6411867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  119.85327   118 123 5.2832726  -13.86056118 12.415691   8.5707183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 131.85675   123 139 1.8315236    0.11513595  4.304081 418.7796260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 141.10661   139 146 4.0598498   -4.07497282  9.540647   8.5085781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 156.08509   150 160 1.8010645    0.01466272  4.232502   5.8543152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 167.73853   161 171 1.6517982   -0.14556475  3.881726  25.5505898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 183.22815   171 188 2.0807233   -0.22145458  4.889700 350.1547326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 193.98654   188 200 2.4682084   -1.29245509  5.800290 119.6729349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 216.44045   200 228 1.8375563   -0.13007404  4.318257 319.6260534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 234.50440   228 238 1.9619252   -0.17648210  4.610524  35.8686113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 243.58113   238 254 4.9483855    0.66568411 11.628706  15.8252538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 262.00099   254 264 1.8302984   -0.98597517  4.301201  17.3957395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 272.87432   264 279 3.0837104    0.05107111  7.246719  96.9289225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 284.45995   279 293 1.8712197   -0.34947361  4.397366 121.3286776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 298.28530   293 303 2.0217365   -0.90317975  4.751081  14.6884289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 320.15708   316 323 1.2587749    0.34041774  2.958121   0.6212100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 336.89949   323 347 2.2339189   -0.82019091  5.249709 157.2481960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 351.82166   347 363 4.3854006    2.73641782 10.305691   7.1109632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 379.01651   363 383 9.6193330  -13.36671547 22.605433   3.8470521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 389.96461   383 390 0.4505309  -11.19848619  1.058748   5.0689224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 396.32753   390 401 7.3086176   -2.14828148 17.175251   6.6276427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 410.94946   401 411 1.7810651 -123.44164907  4.185503   5.5950637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 419.42472   411 421 4.8293969  -14.83514533 11.349083   7.4589610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           area r.squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   141.469804 0.9861795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.534341 0.2835405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    44.203814 0.9996774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   844.468381 0.9954198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     7.861763 0.9445200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     9.913595 0.9974965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  4895.362421 0.9991512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    37.726827 0.8292605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    36.686028 0.9637970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2149.825149 0.9991802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   42.795027 0.9849679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   31.783431 0.9955796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  116.325582 0.9997472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2159.863517 0.9987345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  749.502596 0.9870224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 1996.653868 0.9988400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  231.767485 0.9889112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  148.058990 0.8325458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   88.004196 0.9912112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  713.899661 0.9118992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  753.063437 0.9843055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   84.486071 0.9455491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    2.923790 0.9886961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  972.579140 0.9950354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   70.695957 0.7701393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   63.752468 0.9955775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   30.677295 0.9392470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   64.992481 0.8411157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   54.963920 0.8662737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   67.504644 0.8950062</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ethan Bass.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

